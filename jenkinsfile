def gv
pipeline{
  agent any
  environment{
    NEW_VERSION = '1.0.0' 
  }
  stages{  
  stage("init"){
      steps{
        script{
          gv = load "jenkinsript.groovy"
        }
      }
    }  
  stage("Build"){
      steps{
      withCredentials([
        usernamePassword(credentialsId: 'ShubhamBhardwaj2u', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD')
      ]){
        echo "username = {USERNAME} AND password = {PASSWORD}"
      }
        script{
          gv.buildApp()
        }
      }
    }
    stage("Test"){
      steps{
        script{
          gv.testApp()
        }
      }
    }
    stage("Deploy"){
      steps{
        script{
          gv.deployApp()
        }
      }
    }
  }
}
